[pytest]
# pytest配置文件 - 财务分析系统专用

# 基础配置
minversion = 6.0
addopts =
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --capture=no
    --durations=10

# 测试路径
testpaths = tests

# 标记定义
markers =
    # 测试类型标记
    unit: 单元测试
    integration: 集成测试
    performance: 性能测试
    edge_case: 边界情况测试

    # 功能域标记
    financial: 财务分析相关测试
    akshare: AKShare数据相关测试
    chart: 图表生成测试
    report: 报告生成测试

    # 执行特性标记
    slow: 耗时较长的测试
    network: 需要网络连接的测试
    database: 需要数据库连接的测试

    # 数据类型标记
    mock_data: 使用模拟数据的测试
    real_data: 使用真实数据的测试

# 文件发现模式
python_files =
    test_*.py
    *_test.py
    *_tests.py

python_classes =
    Test*
    Describe*

python_functions =
    test_*
    describe_*

# 异步测试配置
asyncio_mode = auto
asyncio_default_fixture_loop_scope = session

# 日志配置
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s (%(filename)s:%(lineno)d)
log_cli_date_format = %Y-%m-%d %H:%M:%S

# 控制台输出
console_output_style = progress

# 警告过滤
filterwarnings =
    error
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::ResourceWarning
    ignore::matplotlib.MatplotlibDeprecationWarning
    ignore::PIL.Image.DecompressionBombWarning

# 测试超时配置（需要pytest-timeout插件）
# timeout = 600
# timeout_method = thread

# 并行测试配置（需要pytest-xdist）
# addopts = -n auto

# JUnit XML报告
junit_family = xunit2
junit_logging = all

# 财务分析测试特殊配置
# 环境变量示例通过conftest.py的fixture设置